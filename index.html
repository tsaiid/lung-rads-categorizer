<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lung RADS</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Pulmonary Nodule</h3>
                    </div>
                    <div class="panel-body">
                        <form class="form-inline">

                            <div class="" id="texture">
                                <h5>Texture</h5>
                                <label class="radio-inline">
                                    <input type="radio" name="texture" id="" value="s"> Solid
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="texture" id="" value="ps"> Part solid
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="texture" id="" value="ns"> Non-solid
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="texture" id="" value="eb"> Endobronchial
                                </label>
                            </div>


                            <h5>Size</h5>
                            <div class="input-group" id="size">
                                <span class="input-group-addon">Total</span>
                                <input type="text" class="form-control" aria-label="Amount (to the nearest dollar)">
                                <span class="input-group-addon">mm</span>
                            </div>

                            <div class="form-group" id="solid_others">
                                <label class="radio-inline">
                                    <input type="radio" name="solid_others" id="" value="new"> New
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="solid_others" id="" value="g"> Growing
                                </label>

                                <div class="input-group" id="solid_size">
                                    <span class="input-group-addon">Solid</span>
                                    <input type="text" class="form-control" aria-label="Amount (to the nearest dollar)">
                                    <span class="input-group-addon">mm</span>
                                </div>
                            </div>

                            <div class="" id="exam">
                                <h5>Exam</h5>
                                <label class="radio-inline">
                                    <input type="radio" name="exam" id="" value="b"> Baseline
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="exam" id="" value="f"> Follow-up
                                </label>
                            </div>

                            <div class="" id="others">
                                <h5>Follow-up</h5>
                                <label class="radio-inline">
                                    <input type="radio" name="others" id="" value="new"> New
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="others" id="" value="g"> Growing
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="others" id="" value="nc"> No Change
                                </label>
                            </div>
                    </div>
                </div>

                </form>
            </div>

            <div class="col-md-4">

                <div class="ui circular segment">
                    <div class="ui statistic">
                        <div class="value" id="lung_rads">
                            2
                        </div>
                        <div class="label">
                            Lung-RADS
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

    <script type="text/javascript">
    function calculate_rads() {
        size = $('#size input').val();
        solid_size = $('#solid_size input').val();
        solid_others = $('#solid_others :checked').val();
        texture = $('#texture :checked').val();
        exam = $('#exam :checked').val();
        others = $('#others :checked').val();
        lung_rads = ''

        if (size > 0) {
            if (texture.length > 0) {
                switch (texture) {
                    case 's':
                        if ((others == 'new' && size < 4) ||
                            size < 6) {
                            lung_rads = '2';
                        } else if ((exam == 'b' && (size >= 6 && size < 8)) ||
                            (others == 'new' && (size >= 4 && size < 6))) {
                            lung_rads = '3';
                        } else if ((others == 'new' && (size >= 6 && size < 8)) ||
                            (others == 'g' && size < 8) ||
                            (exam == 'b' && size >= 8 && size < 15)) {
                            lung_rads = '4A';
                        } else if (size >= 15 ||
                            (others == 'new' || others == 'g' && size >= 8)) {
                            lung_rads = '4B';
                        } else if (others == 'nc') {
                            lung_rads = '2';
                        } else {
                            lung_rads = '?! s ?!';
                        }
                        break;
                    case 'ps':
                        if (exam == 'b' && size < 6) {
                            lung_rads = '2';
                        } else if ((size >= 6 && solid_size < 6) ||
                            (size < 6 && others == 'new')) {
                            lung_rads = '3';
                        } else if (size >= 6 && (solid_size >= 6 || (solid_others == 'new' || solid_others == 'g' && solid_size < 4))) {
                            lung_rads = '4A';
                        } else if (solid_size >= 8 ||
                            (solid_others == 'new' || solid_others == 'g' && solid_size >= 4)) {
                            lung_rads = '4B';
                        } else {
                            lung_rads = '?! ps ?!';
                        }
                        break;
                    case 'ns':
                        if (size < 20 ||
                            (size >= 20 && others == 'nc')) {
                            lung_rads = '2';
                        } else if ((exam == 'b' || others == 'new') && size >= 20) {
                            lung_rads = '3';
                        } else {
                            lung_rads = '?! ns ?!';
                        }
                        break;
                    case 'eb':
                        lung_rads = '4A';
                        break;
                    default:
                        lung_rads = '?! texture ?!';
                }

                // update innertext
                $('#lung_rads').text(lung_rads)
            }
        } else {
            //alert($('#size').val());
            //validationRules = $('.form').form('get validation', 'size')
            //alert($.fn.form.settings.rules);
        }
    }

    $('input').change(
        function() {
            //alert('changed');
            calculate_rads();
        }
    );
    </script>
</body>

</html>
